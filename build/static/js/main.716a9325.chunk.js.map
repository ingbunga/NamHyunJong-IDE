{"version":3,"sources":["nhj/src/datatypes.js","nhj/src/core.js","nhj/src/std.js","nhj/src/parse.js","nhj/src/tokenizer.js","components/NavigationBar.js","App.js","index.js"],"names":["_Symbol","name","this","Procedure","params","bodys","env","createdFunc","args","createdEnv","Env","scope","arguments","reduce","_","e","_eval","undefined","toString","map","Macro","createdMacro","isMacro","List","schemestr","Array","QuotedSymbol","quote","x","isValue","unQuote","isSymbol","s","isString","String","isNumber","n","Number","outer","acc","i","find","SyntaxError","global_env","op","test","conseq","alt","exp","symbol","slice","Function","bind","proc","execArgs","arg","join","globalThis","window","js_env","math_env","Math","key","xs","length","xs1","xs2","concat","f","x1","x2","JSON","stringify","pow","max","min","console","log","round","standard_env","read_from_token","tokens","parsed","parse_one","token","shift","sub_tkn","push","ftoken","parseFloat","isNaN","isStingAtom","atom","parse","program","chars","clearAcc","saveAcc","shouldBeEmptyAcc","inner_str","before","cur","tokenize","MenuButton","onClick","children","useState","hover","setHover","btnStyle","backgroundColor","color","border","borderRight","cursor","toggle","o","style","onMouseEnter","onMouseLeave","NavigationBar","onExec","onSave","display","height","width","FakeHr","background","App","localStorage","getItem","code","setCode","output","setOutput","AddToOutput","text","print","wrapperRef","useRef","monacoH","setMonacoH","monacoW","setMonacoW","fitSize","setInterval","current","offsetHeight","offsetWidth","onresize","useEffect","flexDirection","replace","forEach","error","setItem","flex","ref","position","language","theme","value","options","selectOnLineNumbers","onChange","newValue","id","fontFamily","overflowY","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"0QAOaA,EAAb,WACI,WAAYC,GAAO,oBACfC,KAAKD,KAAOA,EAFpB,4CAII,WACI,OAAOC,KAAKD,SALpB,KAUO,SAASE,EAAUC,EAAQC,EAAOC,GAErC,IAAMC,EAAc,WAAoB,IAAD,uBAANC,EAAM,yBAANA,EAAM,gBACnC,IAAMC,EAAa,IAAIC,EAAIN,EAAQI,EAAMF,GAGzC,OAFAG,EAAWE,MAAMC,UAAYA,UAEtBP,EAAMQ,QAAO,SAACC,EAAGC,GAAJ,OAAUC,EAAMD,EAAGN,UAAaQ,IAMxD,OAJAV,EAAYW,SAAW,uCACJd,EAAOe,KAAI,SAAAJ,GAAC,cAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAGd,QADf,OAIhBM,EAIJ,SAASa,EAAMhB,EAAQC,EAAOC,GAEjC,IAAMe,EAAe,WAAoB,IAAD,uBAANb,EAAM,yBAANA,EAAM,gBACpC,IAAMC,EAAa,IAAIC,EAAIN,EAAQI,EAAMF,GAGzC,OAFAG,EAAWE,MAAMC,UAAYA,UAEtBP,EAAMQ,QAAO,SAACC,EAAGC,GAAJ,OAAUC,EAAMD,EAAGN,UAAaQ,IAOxD,OALAI,EAAaH,SAAW,mCACTd,EAAOe,KAAI,SAAAJ,GAAC,cAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAGd,QADV,OAGxBoB,EAAaC,SAAU,EAEhBD,EAIJ,IAAME,EAAb,8JACI,WACI,OAAOC,EAAUtB,UAFzB,eAA0BuB,QAObC,EAAb,4HAAkC1B,GAK3B,SAAS2B,EAAMC,GAClB,OAAIC,EAAQD,GACDA,EAEFA,aAAa5B,EACX,IAAI0B,EAAaE,EAAE3B,MAErB2B,aAAaH,MACX,YAAIF,EAAX,YAAmBK,SADlB,EAMF,SAASE,EAAQF,GACpB,OAAIA,aAAaL,EACN,YAAIK,GAENA,aAAaF,EACX,IAAI1B,EAAQ4B,EAAE3B,MAGd2B,EAKR,SAASG,EAASC,GACrB,OAAOA,aAAahC,EAGjB,SAASiC,EAASD,GACrB,MAAsB,kBAAPA,GAAmBA,aAAaE,OAG5C,SAASC,EAASC,GACrB,MAAsB,kBAAPA,GAAmBA,aAAaC,OAO5C,SAASR,EAAQD,GAEpB,OACKA,aAAaL,GACbK,aAAaF,KACZE,aAAaH,UACbG,aAAa5B,GChGhB,IAAMU,EAAb,WACI,aAAmD,IAAvCN,EAAsC,uDAA7B,GAAII,EAAyB,uDAAlB,GAAI8B,EAAc,uDAAN,KAAM,oBAC9CpC,KAAKS,MAAL,2BACOT,KAAKS,OACLP,EAAOS,QAAO,SAAC0B,EAAKxB,EAAGyB,GAAT,mBAAC,eAAoBD,GAArB,kBAA2BxB,EAAEd,KAAOO,EAAKgC,OAAO,KAErEtC,KAAKoC,MAAQA,EANrB,wCASI,SAAKrC,GACD,QAAyBgB,IAArBf,KAAKS,MAAMV,GACX,OAAOC,KAAKS,MAChB,GAAKT,KAAKoC,MAGN,OAAOpC,KAAKoC,MAAMG,KAAKxC,GAFvB,MAAMyC,YAAY,sBAAD,OAAuBzC,QAbpD,KAoBO,SAASe,EAAMY,GAAsB,IAAnBtB,EAAkB,uDAAZqC,EAC3B,GAAIZ,EAASH,GACT,OAAOtB,EAAImC,KAAKb,EAAE3B,MAAM2B,EAAE3B,MAC9B,GAAI4B,EAAQD,GACR,OAAOA,EACX,kBAAsBA,GAAfgB,EAAP,KAAcpC,EAAd,WACA,cAAQoC,QAAR,IAAQA,OAAR,EAAQA,EAAI3C,MACR,IAAK,QACD,OAAO0B,EAAMnB,EAAK,IAEtB,IAAK,KACD,kBAA4BA,EAA5B,GAAOqC,EAAP,KAAaC,EAAb,KAAqBC,EAArB,KACMC,EAAMhC,EAAM6B,EAAMvC,GAAOwC,EAASC,EACxC,OAAO/B,EAAMgC,EAAK1C,GAEtB,IAAK,SACD,kBAAsBE,EAAtB,GAAOyC,EAAP,KAAeD,EAAf,KAEA,OADA1C,EAAIK,MAAMsC,EAAOhD,MAAQe,EAAMgC,EAAK1C,GAC7BA,EAAIK,MAAMsC,EAAOhD,MAE5B,IAAK,OACD,kBAAsBO,EAAtB,GAAOyC,EAAP,KAAeD,EAAf,KACA1C,EAAImC,KAAKQ,EAAOhD,MAAMgD,EAAOhD,MAAQe,EAAMgC,EAAK1C,GAChD,MAEJ,IAAK,SACD,kBAA2BE,GAApBJ,EAAP,KAAkBC,EAAlB,WACA,OAAOF,EAAUC,EAAQC,EAAOC,GAEpC,IAAK,QACD,kBAA2BE,GAApBJ,EAAP,KAAkBC,EAAlB,WACA,OAAOe,EAAMhB,EAAQC,EAAOC,GAEhC,IAAK,IACD,OAAOE,EAAK0C,MAAM,GACbrC,QAAO,SAAC0B,EAAKxB,GAAN,OACJwB,EAAIxB,EAAEd,gBAAiBkD,SACjBZ,EAAIxB,EAAEd,MAAMmD,KAAKb,GACjBA,EAAIxB,EAAEd,QACbe,EAAMR,EAAK,GAAIF,IAE1B,QACI,IAAM+C,EAAOrC,EAAMY,EAAE,GAAItB,GACzB,UAAI+C,QAAJ,IAAIA,OAAJ,EAAIA,EAAM/B,QAAS,CACf,IAAMgC,EAAW9C,EAAKW,KAAI,SAAAoC,GAAG,OAAI5B,EAAM4B,MACvC,OAAOvC,EAAMc,EAAQuB,EAAI,WAAJ,cAAQC,MAG7B,IAAMA,EAAW9C,EAAKW,KAAI,SAAAoC,GAAG,OAAIvC,EAAMuC,EAAKjD,MAC5C,OAAO+C,EAAI,WAAJ,cAAQC,KAOxB,SAAS9B,EAAUwB,GACtB,OAAIjB,EAASiB,GACFA,EAAI/C,KACXgC,EAASe,GACH,IAAN,OAAWA,EAAX,KACAA,aAAevB,MACR,IAAMuB,EAAI7B,IAAIK,GAAWgC,KAAK,KAAO,IAErCtB,OAAOc,GAItB,IAAMS,EAAaC,OAEbC,EAAS,IAAIjD,EACnBiD,EAAOhD,MAAQ8C,EACf,IAAMG,EAAW,IAAIlD,EACrBkD,EAASjD,MAAQkD,KACjBD,EAAStB,MAAQqB,EACV,IAAMhB,EChGN,WACH,IAAMrC,EAAM,IAAII,EAiDhB,IAAK,IAAIoD,KAhDTxD,EAAIK,MAAQ,CACR,IAAkB,sCAAIoD,EAAJ,yBAAIA,EAAJ,uBAAWA,EAAGlD,QAAO,SAAC0B,EAAKxB,GAAN,OAAYwB,EAAMxB,MACzD,IAAkB,sCAAIgD,EAAJ,yBAAIA,EAAJ,uBAAyB,IAAdA,EAAGC,QACAD,EAAG,GACLA,EAAGlD,QAAO,SAAC0B,EAAKxB,GAAN,OAAYwB,EAAMxB,MAC1D,IAAkB,sCAAIgD,EAAJ,yBAAIA,EAAJ,uBAAWA,EAAGlD,QAAO,SAAC0B,EAAKxB,GAAN,OAAYwB,EAAMxB,MACzD,IAAkB,sCAAIgD,EAAJ,yBAAIA,EAAJ,uBAAWA,EAAGlD,QAAO,SAAC0B,EAAKxB,GAAN,OAAYwB,EAAMxB,MACzD,IAAkB,sCAAIgD,EAAJ,yBAAIA,EAAJ,uBAAWA,EAAGb,MAAM,GAAGrC,QAAO,SAAC0B,EAAKxB,EAAGyB,GAAT,OAAeD,GAAOwB,EAAGvB,GAAKzB,KAAG,IACjF,IAAkB,sCAAIgD,EAAJ,yBAAIA,EAAJ,uBAAWA,EAAGb,MAAM,GAAGrC,QAAO,SAAC0B,EAAKxB,EAAGyB,GAAT,OAAeD,GAAOwB,EAAGvB,GAAKzB,KAAG,IACjF,KAAkB,sCAAIgD,EAAJ,yBAAIA,EAAJ,uBAAWA,EAAGb,MAAM,GAAGrC,QAAO,SAAC0B,EAAKxB,EAAGyB,GAAT,OAAeD,GAAOwB,EAAGvB,IAAMzB,KAAG,IAClF,KAAkB,sCAAIgD,EAAJ,yBAAIA,EAAJ,uBAAWA,EAAGb,MAAM,GAAGrC,QAAO,SAAC0B,EAAKxB,EAAGyB,GAAT,OAAeD,GAAOwB,EAAGvB,IAAMzB,KAAG,IAClF,IAAkB,sCAAIgD,EAAJ,yBAAIA,EAAJ,uBAAWA,EAAGb,MAAM,GAAGrC,QAAO,SAAC0B,EAAKxB,EAAGyB,GAAT,OAAeD,GAAOwB,EAAGvB,IAAMzB,KAAG,IAClF,OAAkB,SAACkD,EAAKC,GAAN,OAAcD,EAAIE,OAAOD,IAC3C,MAAkB,SAACH,EAAIK,GAAL,OAAWA,EAAC,WAAD,cAAKL,KAClC,MAAkB,sCAAIvD,EAAJ,yBAAIA,EAAJ,uBAAaA,EAAK0C,OAAO,GAAG,IAC9C,IAAkB,SAAAa,GAAE,OAAIA,EAAG,IAC3B,IAAkB,SAAAA,GAAE,OAAIA,EAAGb,MAAM,IACjC,KAAkB,SAACtB,EAAGmC,GAAJ,MAAW,CAACnC,GAAGuC,OAAOJ,IACxC,MAAkB,SAACM,EAAIC,GAAL,OAAYC,KAAKC,UAAUH,KAAQE,KAAKC,UAAUF,IACpE,KAAkBT,KAAKY,IACvB,SAAkB,SAACJ,EAAIC,GAAL,OAAYD,IAAOC,GACrC,OAAkB,SAAAP,GAAE,OAAIA,EAAGC,QAC3B,KAAkB,sCAAIxD,EAAJ,yBAAIA,EAAJ,mCAAiBe,EAAQf,IAC3C,QAAkB,SAAAoB,GAAC,OAAIA,aAAaL,GACpC,IAAkB,SAAC6C,EAAGL,GAAJ,OAAWA,EAAG5C,IAAIiD,IACpC,IAAkB,kBAA6B,IAAhB,UAAKJ,OACHH,KAAKa,IAAL,MAAAb,KAAI,sDACJA,KAAKa,IAAL,MAAAb,KAAI,YACrC,IAAkB,kBAA6B,IAAhB,UAAKG,OACHH,KAAKc,IAAL,MAAAd,KAAI,sDACJA,KAAKc,IAAL,MAAAd,KAAI,YACrC,IAAkB,SAAAjC,GAAC,OAAKA,GACxB,KAAkB,KAClB,QAAkB,SAAAA,GAAC,OAAU,OAANA,GACvB,UAAkBO,EAClB,MAAkByC,QAAQC,IAC1B,WAAkB,SAAAjD,GAAC,OAAIA,aAAauB,UACpC,MAAkBU,KAAKiB,MACvB,UAAkB7C,EAClB,KAAkB4B,KAClB,IAAkB,SAAAN,GAAG,OAAI,IAAIA,GAC7B,KAAkB,SAAA3B,GAAC,OAAIZ,EAAMc,EAAQF,KACrC,OAAkB,SAAAA,GAAC,cAAWA,GAC9B,gBAAkB,SAAAA,GAAC,OAAIA,aAAaF,GACpC,MAAkB,EAClB,OAAkB,GAGNpB,EAAIK,MAAO,CACvB,IAAII,EAAIT,EAAIK,MAAMmD,GACd/C,aAAaoC,WACbpC,EAAEG,SAAW,6CAErB,OAAOZ,EDyCeyE,GEzGnB,SAASC,EAAgBC,GAC5B,IAAMC,EAAS,GAEf,SAASC,IACL,IAAMC,EAAQH,EAAOI,QAErB,OAAOD,GACH,UAAKnE,EACD,MAAMyB,YAAY,oBAEtB,IAAK,IAED,IADA,IAAM4C,EAAU,GACK,MAAdL,EAAO,IACVK,EAAQC,KAAKJ,KAEjB,OADAF,EAAOI,QACAC,EAEX,IAAK,IACD,MAAM5C,YAAY,gBAEtB,QACI,OAsBT,SAAc0C,GACjB,IAAMI,EAASC,WAAWL,GAC1B,IAAIM,MAAMF,GACN,OAAOA,EACX,OAZJ,SAAqBJ,GACjB,OACIA,EAAMpB,QAAU,GACJ,KAAZoB,EAAM,IACmB,KAAzBA,EAAMA,EAAMpB,OAAO,GAQpB2B,CAAYP,GACJlD,OAAOkD,EAAMlC,MAAM,GAAI,IAEvB,IAAIlD,EAAQoF,GA7BJQ,CAAKR,IAMxB,KAAOH,EAAOjB,OAAS,GACnBkB,EAAOK,KAAKJ,KAGhB,OAAOD,EAuBJ,SAASW,EAAMC,GAClB,OAAOd,EC1DJ,SAAkBe,GACrB,IAAMd,EAAS,GAEX1C,EAAM,GAEV,SAASyD,IACLzD,EAAM,GAGV,SAAS0D,IACM,KAAR1D,GACC0C,EAAOM,KAAKhD,GAIpB,SAAS2D,IACL,GAAW,KAAR3D,EACC,MAAMG,YAFuC,uDAAZ,YAMzC,IAAI,IAAIF,EAAI,EAAGA,EAAIuD,EAAM/B,OAAQxB,IAAK,CAClC,IAAMzB,EAAIgF,EAAMvD,GAEhB,OAAQzB,GACJ,IAAK,IAOL,IAAK,IACDkF,IACAhB,EAAOM,KAAKxE,GACZiF,IACA,MAGJ,IAAK,IACDE,EAAiB,UAAY3D,GAE7B,IAAI4D,EAAY,IAEhB,IAAI3D,GAAK,EAAGA,EAAIuD,EAAM/B,OAAQxB,IAAK,CAC/B,IAAM4D,EAASL,EAAMvD,EAAE,GACjB6D,EAAMN,EAAMvD,GAIlB,GAFA2D,GAAaE,EAEF,MAARA,GAA0B,OAAXD,EACd,MAGRnB,EAAOM,KAAKY,GACZ,MAGJ,IAAK,IAID,IAHAF,IACAD,IAEIxD,GAAK,EAAGA,EAAIuD,EAAM/B,QACF,OAAb+B,EAAMvD,GADiBA,KAI9B,MAGJ,IAAK,KACL,IAAK,IACDyD,IACAD,IACA,MAGJ,QACIzD,GAAOxB,GAOnB,OAFAkF,IAEOhB,ED1BgBqB,CAASR,IFmDpCnD,EAAWL,MAAQsB,E,aI1EnB,SAAS2C,EAAT,GAA0C,IAArBC,EAAoB,EAApBA,QAASC,EAAW,EAAXA,SAC1B,EAA0BC,oBAAS,GAAnC,mBAAOC,EAAP,KAAcC,EAAd,KAEMC,EAAW,CACbC,gBAAiB,YACjBC,MAAO,UACPC,OAAQ,MACRC,YAAa,qBAGbN,IACAE,EAASK,OAAS,WAGtB,IAAMC,EAAS,WACXP,GAAS,SAAAQ,GAAC,OAAKA,MAGnB,OACI,wBAAQC,MAAOR,EAAUS,aAAcH,EAAQI,aAAcJ,EAAQX,QAASA,EAA9E,SACKC,IAKEe,MA3Df,YAGI,IAFAC,EAED,EAFCA,OACAC,EACD,EADCA,OAGMb,EAAW,CACbC,gBAAiB,YACjBC,MAAO,UACPC,OAAQ,MACRC,YAAa,oBACb,UAAW,CACPH,gBAAiB,YAIzB,OACI,sBAAKO,MAAO,CACRM,QAAS,OACTC,OAAQ,OACRC,MAAO,OACPf,gBAAiB,iBAJrB,UAOI,cAACP,EAAD,CAAYc,MAAOR,EAAUL,QAASkB,EAAtC,kBAGA,cAACnB,EAAD,CAAYC,QAASiB,EAAQJ,MAAOR,EAApC,sB,OC8EZ,IAAMiB,EAAS,kBACb,qBAAKT,MAAO,CACVU,WAAY,UACZF,MAAO,OACPD,OAAQ,UAIGI,EA3Gf,WACE,MAAwBtB,oBAAS,kBAC/BhD,OAAOuE,aAAaC,QAAQ,SAC5B,yBAFF,mBAAOC,EAAP,KAAaC,EAAb,KAIA,EAA4B1B,mBAAS,IAArC,mBAAO2B,EAAP,KAAeC,EAAf,KAMA,SAASC,EAAYC,GACnBF,GAAU,SAAAlB,GAAC,4BAAQA,GAAR,CAAWoB,OALxB7F,EAAWhC,MAAM8H,MAAQ,WAAc,IAAD,uBAATjI,EAAS,yBAATA,EAAS,gBACpC+H,EAAY/H,EAAKW,IAAIe,QAAQsB,KAAK,OA2BpC,IAAMkF,EAAaC,iBAAO,MAC1B,EAA8BjC,mBAAS,GAAvC,mBAAOkC,EAAP,KAAgBC,EAAhB,KACA,EAA8BnC,mBAAS,GAAvC,mBAAOoC,EAAP,KAAgBC,EAAhB,KAEMC,EAAU,WACdC,aAAY,WAAO,IAAD,IAChBJ,GAAqB,OAAVH,QAAU,IAAVA,GAAA,UAAAA,EAAYQ,eAAZ,eAAqBC,eAAgB,GAChDJ,GAAqB,OAAVL,QAAU,IAAVA,GAAA,UAAAA,EAAYQ,eAAZ,eAAqBE,cAAe,KAC9C,IAWL,OARA1F,OAAO2F,SAAW,WAChBL,KAGFM,qBAAU,WACRN,MACC,IAGD,sBAAK3B,MAAO,CACVM,QAAS,OACT4B,cAAe,SACf3B,OAAQ,QAHV,UAKE,cAAC,EAAD,CAAeH,OAxCnB,WACEa,EAAU,IACV,IACEzC,EAAMsC,EAAKqB,QAAQ,SAAU,OAAOC,SAAQ,SAAA1I,GAAC,OAAIC,EAAMD,MAEzD,MAAOA,GACLwH,EAAYrG,OAAOnB,IACnB6D,QAAQ8E,MAAM3I,KAiCiB2G,OA7BnC,WACEO,aAAa0B,QAAQ,OAAQxB,MA6B3B,qBAAKd,MAAO,CACRuC,KAAM,GAERC,IAAKnB,EAHP,SAKE,qBAAKrB,MAAO,CACVyC,SAAU,YADZ,SAGE,cAAC,IAAD,CACEjC,MAAO3F,OAAO4G,GAAS,KACvBlB,OAAQ1F,OAAO0G,GAAS,KACxBmB,SAAS,UACTC,MAAM,UACNC,MAAO9B,EACP+B,QAAS,CACPC,qBAAqB,GAEvBC,SA9DV,SAAkBC,EAAUtJ,GAC1BqH,EAAQiC,UAiEN,cAAC,EAAD,IACA,qBAAKC,GAAG,SAASjD,MAAO,CACtBU,WAAY,kBACZhB,MAAO,QACPc,MAAO,OACPD,OAAQ,QACR2C,WAAY,YACZC,UAAW,QANb,SAQGnC,EAAOlH,KAAI,SAAAJ,GAAC,OACX,8BAAcA,GAAJA,YC/FpB0J,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.716a9325.chunk.js","sourcesContent":["import {\n    Env,\n    _eval,\n    schemestr,\n} from './core.js'\n\n\nexport class _Symbol {\n    constructor(name) {\n        this.name = name;\n    }\n    toString() {\n        return this.name;\n    }\n}\n\n\nexport function Procedure(params, bodys, env) {\n\n    const createdFunc = function (...args) {\n        const createdEnv = new Env(params, args, env);\n        createdEnv.scope.arguments = arguments;\n\n        return bodys.reduce((_, e) => _eval(e, createdEnv), undefined);\n    };\n    createdFunc.toString = () => (\n        `[Procedure (${params.map(e => e?.name)})]`\n    );\n\n    return createdFunc;\n}\n\n\nexport function Macro(params, bodys, env) {\n\n    const createdMacro = function (...args) {\n        const createdEnv = new Env(params, args, env);\n        createdEnv.scope.arguments = arguments;\n\n        return bodys.reduce((_, e) => _eval(e, createdEnv), undefined);\n    }\n    createdMacro.toString = () => (\n        `[Macro (${params.map(e => e?.name)})]`\n    );\n    createdMacro.isMacro = true;\n\n    return createdMacro;\n}\n\n\nexport class List extends Array {\n    toString() {\n        return schemestr(this);\n    }\n}\n\n\nexport class QuotedSymbol extends _Symbol{\n\n}\n\n\nexport function quote(x) {\n    if (isValue(x)) {\n        return x;\n    }\n    else if (x instanceof _Symbol) {\n        return new QuotedSymbol(x.name);\n    }\n    else if (x instanceof Array) {\n        return new List(...x);\n    }\n}\n\n\nexport function unQuote(x) {\n    if (x instanceof List) {\n        return [...x];\n    }\n    else if (x instanceof QuotedSymbol) {\n        return new _Symbol(x.name);\n    }\n    else {\n        return x;\n    }\n}\n\n\nexport function isSymbol(s) {\n    return s instanceof _Symbol;\n}\n\nexport function isString(s) {\n    return typeof (s) === 'string' || s instanceof String;\n}\n\nexport function isNumber(n) {\n    return typeof (n) === 'number' || n instanceof Number;\n}\n\n/**\n * value means not AST\n * likes Number, String, List...\n */\nexport function isValue(x) {\n    // Array means AST.\n    return (\n        (x instanceof List) ||\n        (x instanceof QuotedSymbol) ||\n        !(x instanceof Array) &&\n        !(x instanceof _Symbol)\n    );\n}","import {\n    Macro,\n    Procedure,\n    isString,\n    isSymbol,\n    isValue,\n    quote,\n    unQuote\n} from './datatypes.js';\nimport {\n    standard_env\n} from './std.js'\n\n\nexport class Env {\n    constructor(params = [], args = [], outer = null) {\n        this.scope = {\n            ...this.scope,\n            ...params.reduce((acc, e, i) => ({ ...acc, [e.name]: args[i] }), {}),\n        };\n        this.outer = outer;\n    }\n\n    find(name) {\n        if (this.scope[name] !== undefined)\n            return this.scope;\n        if (!this.outer)\n            throw SyntaxError(`cannot find symbol ${name}`);\n        else\n            return this.outer.find(name);\n    }\n}\n\n\nexport function _eval(x, env = global_env) {\n    if (isSymbol(x))\n        return env.find(x.name)[x.name];\n    if (isValue(x)) // Quoted, Number, String, ...\n        return x;\n    const [op, ...args] = x;\n    switch (op?.name) {\n        case 'quote': {\n            return quote(args[0]);\n        }\n        case 'if': {\n            const [test, conseq, alt] = args;\n            const exp = _eval(test, env) ? conseq : alt;\n            return _eval(exp, env);\n        }\n        case 'define': {\n            const [symbol, exp] = args;\n            env.scope[symbol.name] = _eval(exp, env);\n            return env.scope[symbol.name];\n        }\n        case 'set!': {\n            const [symbol, exp] = args;\n            env.find(symbol.name)[symbol.name] = _eval(exp, env);\n            break;\n        }\n        case 'lambda': {\n            const [params, ...bodys] = args;\n            return Procedure(params, bodys, env);\n        }\n        case 'macro': {\n            const [params, ...bodys] = args;\n            return Macro(params, bodys, env);\n        }\n        case '.': {\n            return args.slice(1)\n                .reduce((acc, e) => (\n                    acc[e.name] instanceof Function\n                        ? acc[e.name].bind(acc)\n                        : acc[e.name]\n                ), _eval(args[0], env));\n        }\n        default: {\n            const proc = _eval(x[0], env);\n            if (proc?.isMacro) {\n                const execArgs = args.map(arg => quote(arg));\n                return _eval(unQuote(proc(...execArgs)));\n            }\n            else {\n                const execArgs = args.map(arg => _eval(arg, env));\n                return proc(...execArgs);\n            }\n        }\n    }\n}\n\n\nexport function schemestr(exp) {\n    if (isSymbol(exp))\n        return exp.name;\n    if (isString(exp))\n        return `\"${exp}\"`;\n    if (exp instanceof Array)\n        return '(' + exp.map(schemestr).join(' ') + ')';\n    else\n        return String(exp);\n}\n\n\nconst globalThis = window; // quick fix\n\nconst js_env = new Env();\njs_env.scope = globalThis;\nconst math_env = new Env();\nmath_env.scope = Math;\nmath_env.outer = js_env;\nexport const global_env = standard_env();\nglobal_env.outer = math_env;","import {\n    Env,\n    _eval,\n} from './core.js';\nimport {\n    List,\n    QuotedSymbol,\n    isNumber,\n    isString,\n    unQuote\n} from './datatypes.js';\n\n\nexport function standard_env() {\n    const env = new Env();\n    env.scope = {\n        '+'             : (...xs) => xs.reduce((acc, e) => acc + e),\n        '-'             : (...xs) => xs.length === 1\n                                     ? -xs[0]\n                                     :xs.reduce((acc, e) => acc - e),\n        '*'             : (...xs) => xs.reduce((acc, e) => acc * e),\n        '/'             : (...xs) => xs.reduce((acc, e) => acc / e),\n        '>'             : (...xs) => xs.slice(1).reduce((acc, e, i) => acc && xs[i] > e, true),\n        '<'             : (...xs) => xs.slice(1).reduce((acc, e, i) => acc && xs[i] < e, true),\n        '>='            : (...xs) => xs.slice(1).reduce((acc, e, i) => acc && xs[i] >= e, true),\n        '<='            : (...xs) => xs.slice(1).reduce((acc, e, i) => acc && xs[i] <= e, true),\n        '='             : (...xs) => xs.slice(1).reduce((acc, e, i) => acc && xs[i] == e, true),\n        'append'        : (xs1, xs2) => xs1.concat(xs2),\n        'apply'         : (xs, f) => f(...xs),\n        'begin'         : (...args) => args.slice(-1)[0],\n        'car'           : xs => xs[0],\n        'cdr'           : xs => xs.slice(1),\n        'cons'          : (x, xs) => [x].concat(xs),\n        'eq?'           : (x1, x2) => JSON.stringify(x1) === JSON.stringify(x2),\n        'expt'          : Math.pow,\n        'equal?'        : (x1, x2) => x1 === x2,\n        'length'        : xs => xs.length,\n        'list'          : (...args) => new List(...args),\n        'list?'         : x => x instanceof List,\n        'map'           : (f, xs) => xs.map(f),\n        'max'           : (...args) => args.length === 1\n                                       ? Math.max(...args[0])\n                                       : Math.max(...args),\n        'min'           : (...args) => args.length === 1\n                                       ? Math.min(...args[0])\n                                       : Math.min(...args),\n        'not'           : x => !x,\n        'null'          : null,\n        'null?'         : x => x === null,\n        'number?'       : isNumber,\n        'print'         : console.log,\n        'produre?'      : x => x instanceof Function,\n        'round'         : Math.round,\n        'string?'       : isString,\n        'Math'          : Math,\n        'new'           : arg => new arg,\n        'eval'          : x => _eval(unQuote(x)),\n        'typeof'        : x => typeof x,\n        'quotedSymbol?' : x => x instanceof QuotedSymbol,\n        'true'          : true,\n        'false'         : false,\n    };\n    \n    for (let key in env.scope) {\n        let e = env.scope[key];\n        if (e instanceof Function)\n            e.toString = () => `[NativeProcedure (...)]`\n    }\n    return env;\n}","import { _Symbol } from './datatypes.js';\nimport { tokenize } from './tokenizer.js';\n\n\nexport function read_from_token(tokens) {\n    const parsed = [];\n    \n    function parse_one() {\n        const token = tokens.shift();\n    \n        switch(token) {\n            case undefined: {\n                throw SyntaxError(\"uncomplete input\");\n            }\n            case '(': {\n                const sub_tkn = []\n                while (tokens[0] !== ')')\n                    sub_tkn.push(parse_one(tokens))\n                tokens.shift(); // remove ')'\n                return sub_tkn;\n            }\n            case ')': {\n                throw SyntaxError('unexpected )');\n            }   \n            default: {\n                return atom(token);\n            }\n                \n        }\n    }\n\n    while (tokens.length > 0) {\n        parsed.push(parse_one());\n    }\n\n    return parsed;\n}\n\n\nfunction isStingAtom(token) {\n    return (\n        token.length >= 2 &&\n        token[0] == '\"' &&\n        token[token.length-1] == '\"'\n    )\n}\n\nexport function atom(token) {\n    const ftoken = parseFloat(token);\n    if(!isNaN(ftoken))\n        return ftoken\n    if(isStingAtom(token))\n        return String(token.slice(1, -1))\n    else\n        return new _Symbol(token)\n}\n\n\nexport function parse(program) {\n    return read_from_token(tokenize(program))\n}\n\n\n","\nexport function tokenize(chars) {\n    const tokens = [];\n\n    let acc = '';\n\n    function clearAcc() {\n        acc = '';\n    }\n\n    function saveAcc() {\n        if(acc !== '') {\n            tokens.push(acc)\n        }\n    }\n\n    function shouldBeEmptyAcc(errorMessage = \"no space\") {\n        if(acc !== '') {\n            throw SyntaxError(errorMessage)\n        }\n    }\n\n    for(let i = 0; i < chars.length; i++) {\n        const e = chars[i];\n\n        switch (e) {\n            case '(': { // list\n                saveAcc();\n                tokens.push(e);\n                clearAcc();\n                break;\n            }\n\n            case ')': {\n                saveAcc();\n                tokens.push(e);\n                clearAcc();\n                break;\n            }\n\n            case '\"': { // string\n                shouldBeEmptyAcc('nospace' + acc);\n                \n                let inner_str = '\"';\n                \n                for(i += 1; i < chars.length; i++) {\n                    const before = chars[i-1];\n                    const cur = chars[i];\n                    \n                    inner_str += cur;\n\n                    if(cur === '\"' && before !== '\\\\')\n                        break;\n                }\n\n                tokens.push(inner_str);\n                break;\n            }\n\n            case ';': { // comment\n                saveAcc();\n                clearAcc();\n                \n                for(i += 1; i < chars.length; i++)\n                    if(chars[i] === '\\n')\n                        break;\n                \n                break;\n            }  \n            \n            case '\\n':  // change line\n            case ' ' : { // space\n                saveAcc();\n                clearAcc();\n                break;\n            }\n\n            default: {\n                acc += e;\n            }\n        }\n    }\n\n    saveAcc();\n\n    return tokens;\n    \n}\n","import React, { useState } from 'react';\n\nfunction NavigationBar({\n    onExec,\n    onSave,\n}) {\n\n    const btnStyle = {\n        backgroundColor: '#00000000',\n        color: '#a2a2a2',\n        border: '0px',\n        borderRight: '1px solid #a2a2a2',\n        \"&:hover\": {\n            backgroundColor: '#a2a2a2',\n        }\n    }\n\n    return (\n        <div style={{\n            display: 'flex',\n            height: '25px',\n            width: '100%',\n            backgroundColor: 'rgb(29,29,29)'\n        }}>\n            \n            <MenuButton style={btnStyle} onClick={onSave}>\n                save\n            </MenuButton>\n            <MenuButton onClick={onExec} style={btnStyle}>\n                exec\n            </MenuButton>\n        </div>\n    )\n}\n\n\nfunction MenuButton({onClick, children}) {\n    const [hover, setHover] = useState(false);\n\n    const btnStyle = {\n        backgroundColor: '#00000000',\n        color: '#a2a2a2',\n        border: '0px',\n        borderRight: '1px solid #a2a2a2',\n    }\n\n    if (hover) {\n        btnStyle.cursor = 'pointer';\n    }\n\n    const toggle = () => {\n        setHover(o => !o);\n    }\n\n    return (\n        <button style={btnStyle} onMouseEnter={toggle} onMouseLeave={toggle} onClick={onClick}>\n            {children}\n        </button>\n    )\n}\n\nexport default NavigationBar;","import React, { useEffect, useRef, useState } from 'react';\nimport MonacoEditor from 'react-monaco-editor';\nimport { global_env, _eval, } from './nhj/src/core';\nimport { parse } from './nhj/src/parse.js';\nimport NavigationBar from './components/NavigationBar';\nimport * as _ from 'lodash';\n\nfunction App() {\n  const [code, setCode] = useState(() => (\n    window.localStorage.getItem('code') ||\n    '; type your code...'\n  ));\n  const [output, setOutput] = useState([]);\n\n  global_env.scope.print = (...args) => {\n    AddToOutput(args.map(String).join(' '));\n  }\n\n  function AddToOutput(text) {\n    setOutput(o => [...o, text]);\n  }\n\n\n  function onChange(newValue, e) {\n    setCode(newValue);\n  }\n\n  function onExec() {\n    setOutput([]);\n    try {\n      parse(code.replace(/\\r\\n/gi, '\\n')).forEach(e => _eval(e));\n    }\n    catch (e) {\n      AddToOutput(String(e));\n      console.error(e);\n    }\n  }\n\n  function onSave() {\n    localStorage.setItem('code', code);\n  }\n\n  const wrapperRef = useRef(null);\n  const [monacoH, setMonacoH] = useState(0);\n  const [monacoW, setMonacoW] = useState(0);\n\n  const fitSize = function () {\n    setInterval(() => {\n      setMonacoH(wrapperRef?.current?.offsetHeight || 0);\n      setMonacoW(wrapperRef?.current?.offsetWidth || 0);\n    }, 0);\n  };\n\n  window.onresize = () => {\n    fitSize();\n  }\n\n  useEffect(() => {\n    fitSize();\n  }, [])\n\n  return (\n    <div style={{\n      display: 'flex',\n      flexDirection: 'column',\n      height: '100%'\n    }}>\n      <NavigationBar onExec={onExec} onSave={onSave}/>\n      <div style={{\n          flex: 1,\n        }}\n        ref={wrapperRef}\n      >\n        <div style={{\n          position: 'absolute',\n        }}>\n          <MonacoEditor\n            width={String(monacoW)+'px'}\n            height={String(monacoH)+'px'}\n            language=\"clojure\"\n            theme=\"vs-dark\"\n            value={code}\n            options={{\n              selectOnLineNumbers: true,\n            }}\n            onChange={onChange}\n          />\n        </div>\n      </div>\n      <FakeHr />\n      <div id=\"output\" style={{\n        background: 'rgb(29, 29, 29)',\n        color: 'white',\n        width: '100%',\n        height: '200px',\n        fontFamily: 'monospace',\n        overflowY: 'auto',\n      }}>\n        {output.map(e => (\n          <div key={e}>{e}</div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nconst FakeHr = () => (\n  <div style={{\n    background: '#616161',\n    width: '100%',\n    height: '2px',\n  }} />\n)\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n\n"],"sourceRoot":""}